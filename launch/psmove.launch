<launch>
  <!-- <node name="psmove_driver" -->
  <!--       pkg="jsk_2014w_rinko" type="psmove_driver" -->
  <!--       output="screen"> -->
  <!-- </node> -->

  <arg name="use_oculus" default="true" />
  <arg name="use_psmove" default="true" />
  <arg name="use_kalman_filter" default="true" />
  <arg name="launch_rviz" default="true" />
  <arg name="launch_usbcam" default="false" />
  <arg name="launch_openni" default="true" />
  <arg name="image" default="/camera/rgb/image_rect_color" />


  <group if="$(arg use_psmove)">
    <node name="psmove_tracker"
          pkg="jsk_2014w_rinko" type="psmove_tracker"
          >
      <remap from="image" to="$(arg image)" />
      <remap from="psmove" to="psmove_unfiltered" if="$(arg use_kalman_filter)" />
      <param name="debug" value="false" />
      <param name="color_r" value="255" />
      <param name="color_b" value="255" />
      <param name="color_threshold" value="10" />
      <param name="lpf_threshold" value="1" />
      <param name="min_radius" value="5" />
      <param name="max_radius" value="140" />
    </node>

    <node name="psmove_kalman_filter"
          pkg="jsk_2014w_rinko" type="linear_3d_kalman_filter"
          if="$(arg use_kalman_filter)"
          >
      <remap from="pose" to="psmove_unfiltered" />
      <remap from="pose_filtered" to="psmove" />
    </node>

    <node name="usb_cam"
          pkg="usb_cam" type="usb_cam_node"
          if="$(arg launch_usbcam)" />
    <include file="$(find openni_launch)/launch/openni.launch"
             if="$(arg launch_openni)" />

    <node name="pr2_psmove_controller"
          pkg="jsk_2014w_rinko" type="pr2_psmove_controller.l"
          />
  </group>

  <group if="$(arg use_oculus)">
    <node name="rviz" pkg="rviz" type="rviz"
          args="-d $(find jsk_2014w_rinko)/cfg/oculus_rviz_config.rviz"
          if="$(arg launch_rviz)" />
    <node name="pr2_oculus_controller"
          pkg="jsk_2014w_rinko" type="pr2_oculus_controller.l" />
  </group>

</launch>
